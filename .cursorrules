# PadelSense Court System - Cursor AI Rules
# –í–µ—Ä—Å–∏—è: 1.0 | –Ø–Ω–≤–∞—Ä—å 2025

## üéØ –ö–û–ù–¢–ï–ö–°–¢ –ü–†–û–ï–ö–¢–ê

–¢—ã —Ä–∞–±–æ—Ç–∞–µ—à—å –Ω–∞–¥ **PadelSense** ‚Äî —Å–∏—Å—Ç–µ–º–æ–π —É–º–Ω–æ–≥–æ –∫–æ—Ä—Ç–∞ –¥–ª—è –ø–∞–¥–µ–ª-–∫–ª—É–±–æ–≤.

**–ß—Ç–æ —Å–∏—Å—Ç–µ–º–∞ –¥–µ–ª–∞–µ—Ç:**
- –ó–∞–ø–∏—Å—ã–≤–∞–µ—Ç –≤–∏–¥–µ–æ –≤—Å–µ—Ö –º–∞—Ç—á–µ–π –Ω–∞ –∫–æ—Ä—Ç–µ
- –í–µ–¥—ë—Ç —Å—á—ë—Ç (—Ä—É—á–Ω–æ–π –≤–≤–æ–¥ ‚Üí –ø–æ—Ç–æ–º –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–π AI)
- –ò–¥–µ–Ω—Ç–∏—Ñ–∏—Ü–∏—Ä—É–µ—Ç –∏–≥—Ä–æ–∫–æ–≤ —á–µ—Ä–µ–∑ QR-–∫–æ–¥ –≤ Telegram
- –û—Ç–ø—Ä–∞–≤–ª—è–µ—Ç –∏–≥—Ä–æ–∫–∞–º –≤–∏–¥–µ–æ –∏ —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫—É

**–ö–æ–º–ø–æ–Ω–µ–Ω—Ç—ã –ø—Ä–æ–µ–∫—Ç–∞:**
1. `telegram-bot/` ‚Äî Python –±–æ—Ç –Ω–∞ aiogram 3.x (—Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è, QR-–∫–æ–¥—ã, —É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è)
2. `mini-app/` ‚Äî Telegram Mini App –Ω–∞ React + TypeScript (—Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è)
3. `backend/` ‚Äî FastAPI —Å–µ—Ä–≤–µ—Ä (API, –±–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö, –æ–±—Ä–∞–±–æ—Ç–∫–∞ –≤–∏–¥–µ–æ)
4. `tablet-app/` ‚Äî React Native + Expo –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ –¥–ª—è –ø–ª–∞–Ω—à–µ—Ç–∞ –Ω–∞ –∫–æ—Ä—Ç–µ (–†–ê–ó–†–ê–ë–ê–¢–´–í–ê–ï–¢–°–Ø –í WINDSURF!)
5. `ml/` ‚Äî Computer Vision –º–æ–¥–µ–ª–∏ (–ø–æ–∑–∂–µ)

---

## ‚ö†Ô∏è –ö–†–ò–¢–ò–ß–ï–°–ö–ò –í–ê–ñ–ù–û

### –°–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏—è —Å Windsurf
–ü–ª–∞–Ω—à–µ—Ç–Ω–æ–µ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ (`tablet-app/`) —Ä–∞–∑—Ä–∞–±–∞—Ç—ã–≤–∞–µ—Ç—Å—è –≤ **Windsurf**!
- –ù–ï —Ä–µ–¥–∞–∫—Ç–∏—Ä—É–π —Ñ–∞–π–ª—ã –≤ `tablet-app/` –±–µ–∑ —è–≤–Ω–æ–π –ø—Ä–æ—Å—å–±—ã
- –û–±—â–∏–µ —Ç–∏–ø—ã –ª–µ–∂–∞—Ç –≤ `shared/types/` ‚Äî –∏–∑–º–µ–Ω–µ–Ω–∏—è —Ç—Ä–µ–±—É—é—Ç —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏–∏
- –ü—Ä–∏ –∏–∑–º–µ–Ω–µ–Ω–∏–∏ API –∫–æ–Ω—Ç—Ä–∞–∫—Ç–æ–≤ ‚Äî –û–ë–Ø–ó–ê–¢–ï–õ–¨–ù–û —É–∫–∞–∂–∏ —á—Ç–æ –Ω—É–∂–Ω–æ –æ–±–Ω–æ–≤–∏—Ç—å –≤ Windsurf

### QR-–∫–æ–¥ —Ñ–æ—Ä–º–∞—Ç
```
user:{telegram_id}
```
–ü—Ä–∏–º–µ—Ä: `user:123456789`

### –ü–æ–∑–∏—Ü–∏–∏ –Ω–∞ –∫–æ—Ä—Ç–µ
```
1 = –õ–µ–≤—ã–π –±–ª–∏–∂–Ω–∏–π
2 = –ü—Ä–∞–≤—ã–π –±–ª–∏–∂–Ω–∏–π
3 = –õ–µ–≤—ã–π –¥–∞–ª—å–Ω–∏–π
4 = –ü—Ä–∞–≤—ã–π –¥–∞–ª—å–Ω–∏–π
```

---

## üìÅ –°–¢–†–£–ö–¢–£–†–ê –ü–†–û–ï–ö–¢–ê

```
padelsense-court/
‚îú‚îÄ‚îÄ .cursorrules              # ‚Üê –≠—Ç–æ—Ç —Ñ–∞–π–ª
‚îú‚îÄ‚îÄ .windsurfrules            # –ü—Ä–∞–≤–∏–ª–∞ –¥–ª—è Windsurf (–Ω–µ —Ç—Ä–æ–≥–∞—Ç—å)
‚îú‚îÄ‚îÄ shared/                   # –û–±—â–∏–µ —Ç–∏–ø—ã –∏ –∫–æ–Ω—Ç—Ä–∞–∫—Ç—ã
‚îÇ   ‚îú‚îÄ‚îÄ types/
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ user.ts           # UserProfile, RegistrationData
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ match.ts          # Match, MatchPlayer, Score
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ court.ts          # Court, CourtPosition
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ api.ts            # API –∫–æ–Ω—Ç—Ä–∞–∫—Ç—ã
‚îÇ   ‚îî‚îÄ‚îÄ constants/
‚îÇ       ‚îú‚îÄ‚îÄ qr-format.ts      # QR –∫–æ–¥ —Å–ø–µ—Ü–∏—Ñ–∏–∫–∞—Ü–∏–∏
‚îÇ       ‚îî‚îÄ‚îÄ positions.ts      # –ü–æ–∑–∏—Ü–∏–∏ –Ω–∞ –∫–æ—Ä—Ç–µ
‚îÇ
‚îú‚îÄ‚îÄ telegram-bot/             # Python –±–æ—Ç
‚îÇ   ‚îú‚îÄ‚îÄ main.py
‚îÇ   ‚îú‚îÄ‚îÄ handlers/
‚îÇ   ‚îú‚îÄ‚îÄ keyboards/
‚îÇ   ‚îú‚îÄ‚îÄ services/
‚îÇ   ‚îî‚îÄ‚îÄ requirements.txt
‚îÇ
‚îú‚îÄ‚îÄ mini-app/                 # Telegram Mini App
‚îÇ   ‚îú‚îÄ‚îÄ src/
‚îÇ   ‚îú‚îÄ‚îÄ package.json
‚îÇ   ‚îî‚îÄ‚îÄ vite.config.ts
‚îÇ
‚îú‚îÄ‚îÄ backend/                  # FastAPI
‚îÇ   ‚îú‚îÄ‚îÄ api/
‚îÇ   ‚îú‚îÄ‚îÄ models/
‚îÇ   ‚îú‚îÄ‚îÄ services/
‚îÇ   ‚îî‚îÄ‚îÄ requirements.txt
‚îÇ
‚îî‚îÄ‚îÄ tablet-app/               # ‚ö†Ô∏è WINDSURF ONLY
    ‚îî‚îÄ‚îÄ (–Ω–µ —Ä–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞—Ç—å –≤ Cursor)
```

---

## üêç PYTHON –ü–†–ê–í–ò–õ–ê

### –û–±—â–∏–µ
- Python 3.11+
- Type hints –û–ë–Ø–ó–ê–¢–ï–õ–¨–ù–´ –¥–ª—è –≤—Å–µ—Ö —Ñ—É–Ω–∫—Ü–∏–π
- Docstrings –Ω–∞ —Ä—É—Å—Å–∫–æ–º –¥–ª—è –±–∏–∑–Ω–µ—Å-–ª–æ–≥–∏–∫–∏
- Black formatter (line-length=88)
- isort –¥–ª—è –∏–º–ø–æ—Ä—Ç–æ–≤

### Aiogram 3.x
```python
# –ü—Ä–∞–≤–∏–ª—å–Ω—ã–π –∏–º–ø–æ—Ä—Ç
from aiogram import Router, F
from aiogram.types import Message, CallbackQuery
from aiogram.filters import Command, StateFilter
from aiogram.fsm.context import FSMContext
from aiogram.fsm.state import State, StatesGroup

# –°—Ç—Ä—É–∫—Ç—É—Ä–∞ —Ö—ç–Ω–¥–ª–µ—Ä–∞
router = Router(name="–Ω–∞–∑–≤–∞–Ω–∏–µ")

@router.message(Command("start"))
async def cmd_start(message: Message, state: FSMContext) -> None:
    """–û–±—Ä–∞–±–æ—Ç–∫–∞ –∫–æ–º–∞–Ω–¥—ã /start."""
    pass
```

### FastAPI
```python
# –†–æ—É—Ç–µ—Ä
from fastapi import APIRouter, Depends, HTTPException, status
from pydantic import BaseModel

router = APIRouter(prefix="/api/v1", tags=["–Ω–∞–∑–≤–∞–Ω–∏–µ"])

# –ú–æ–¥–µ–ª–∏ Pydantic
class UserCreate(BaseModel):
    telegram_id: int
    name: str
    
    class Config:
        from_attributes = True
```

### –û–±—Ä–∞–±–æ—Ç–∫–∞ –æ—à–∏–±–æ–∫
```python
# –í—Å–µ–≥–¥–∞ –∫–æ–Ω–∫—Ä–µ—Ç–Ω—ã–µ –∏—Å–∫–ª—é—á–µ–Ω–∏—è
try:
    result = await some_operation()
except SpecificError as e:
    logger.error(f"–û—à–∏–±–∫–∞ –æ–ø–µ—Ä–∞—Ü–∏–∏: {e}")
    raise HTTPException(status_code=400, detail=str(e))
```

---

## üìò TYPESCRIPT –ü–†–ê–í–ò–õ–ê

### –û–±—â–∏–µ
- Strict mode –û–ë–Ø–ó–ê–¢–ï–õ–ï–ù
- –ù–∏–∫–∞–∫–∏—Ö `any` ‚Äî –∏—Å–ø–æ–ª—å–∑—É–π `unknown` + type guards
- –ò–Ω—Ç–µ—Ä—Ñ–µ–π—Å—ã –¥–ª—è –æ–±—ä–µ–∫—Ç–æ–≤, —Ç–∏–ø—ã –¥–ª—è unions/–ø—Ä–∏–º–∏—Ç–∏–≤–æ–≤

### Shared Types
```typescript
// shared/types/user.ts
export interface UserProfile {
  telegramId: number;
  name: string;
  avatarUrl?: string;
  qrCode: string;
  createdAt: Date;
}

// shared/types/match.ts
export interface MatchPlayer {
  userId: number;
  position: CourtPosition;
  team: 'A' | 'B';
}

export type CourtPosition = 1 | 2 | 3 | 4;
```

### API –ö–æ–Ω—Ç—Ä–∞–∫—Ç—ã
```typescript
// shared/types/api.ts
export interface ApiResponse<T> {
  success: boolean;
  data?: T;
  error?: string;
}

export interface CreateUserRequest {
  telegramId: number;
  name: string;
  phone?: string;
}

export interface CreateUserResponse {
  user: UserProfile;
  qrCode: string;
}
```

---

## üîÑ –°–ò–ù–•–†–û–ù–ò–ó–ê–¶–ò–Ø –ò–ó–ú–ï–ù–ï–ù–ò–ô

–ü—Ä–∏ –∏–∑–º–µ–Ω–µ–Ω–∏–∏ shared —Ç–∏–ø–æ–≤ –∏–ª–∏ API:

1. **–û–±–Ω–æ–≤–∏ —Ñ–∞–π–ª –≤ `shared/`**
2. **–°–æ–∑–¥–∞–π CHANGELOG –∑–∞–ø–∏—Å—å:**
```markdown
## [SYNC REQUIRED] 2025-01-XX

### –ò–∑–º–µ–Ω–µ–Ω–æ
- `shared/types/user.ts`: –¥–æ–±–∞–≤–ª–µ–Ω–æ –ø–æ–ª–µ `avatarUrl`

### –î–µ–π—Å—Ç–≤–∏—è –¥–ª—è Windsurf
- –û–±–Ω–æ–≤–∏—Ç—å `tablet-app/src/types/user.ts`
- –ü—Ä–æ–≤–µ—Ä–∏—Ç—å `PlayerCard` –∫–æ–º–ø–æ–Ω–µ–Ω—Ç
```

3. **–°–∫–∞–∂–∏ –º–Ω–µ** —á—Ç–æ –Ω—É–∂–Ω–æ —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∏—Ä–æ–≤–∞—Ç—å

---

## üõ†Ô∏è –ö–û–ú–ê–ù–î–´

### Telegram Bot
```bash
cd telegram-bot
python -m venv venv
source venv/bin/activate  # –∏–ª–∏ venv\Scripts\activate –Ω–∞ Windows
pip install -r requirements.txt
python main.py
```

### Mini App
```bash
cd mini-app
npm install
npm run dev
```

### Backend
```bash
cd backend
python -m venv venv
source venv/bin/activate
pip install -r requirements.txt
uvicorn main:app --reload
```

---

## üìù –°–¢–ò–õ–¨ –û–¢–í–ï–¢–û–í

1. **–°–Ω–∞—á–∞–ª–∞ –ø–ª–∞–Ω** ‚Äî –æ–ø–∏—à–∏ —á—Ç–æ –±—É–¥–µ—à—å –¥–µ–ª–∞—Ç—å
2. **–ü–æ—Ç–æ–º –∫–æ–¥** ‚Äî —Å –∫–æ–º–º–µ–Ω—Ç–∞—Ä–∏—è–º–∏
3. **–í –∫–æ–Ω—Ü–µ —á–µ–∫–ª–∏—Å—Ç** ‚Äî —á—Ç–æ –ø—Ä–æ–≤–µ—Ä–∏—Ç—å, —á—Ç–æ —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∏—Ä–æ–≤–∞—Ç—å

### –ü—Ä–∏–º–µ—Ä –æ—Ç–≤–µ—Ç–∞:
```
## –ü–ª–∞–Ω
1. –°–æ–∑–¥–∞–º –º–æ–¥–µ–ª—å User –≤ backend
2. –î–æ–±–∞–≤–ª—é —ç–Ω–¥–ø–æ–∏–Ω—Ç POST /users
3. –û–±–Ω–æ–≤–ª—é shared —Ç–∏–ø—ã

## –ö–æ–¥
[–∫–æ–¥ —Å –∫–æ–º–º–µ–Ω—Ç–∞—Ä–∏—è–º–∏]

## –ß–µ–∫–ª–∏—Å—Ç
- [ ] –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –º–∏–≥—Ä–∞—Ü–∏—é –ë–î
- [ ] –û–±–Ω–æ–≤–∏—Ç—å Windsurf: –¥–æ–±–∞–≤–∏—Ç—å —Ç–∏–ø UserProfile
- [ ] –ü—Ä–æ—Ç–µ—Å—Ç–∏—Ä–æ–≤–∞—Ç—å —á–µ—Ä–µ–∑ Thunder Client
```

---

## üö´ –ù–ï –î–ï–õ–ê–ô

- –ù–µ –∏—Å–ø–æ–ª—å–∑—É–π `print()` ‚Äî —Ç–æ–ª—å–∫–æ `logging`
- –ù–µ —Ö–∞—Ä–¥–∫–æ–¥—å credentials ‚Äî –∏—Å–ø–æ–ª—å–∑—É–π .env
- –ù–µ —Ä–µ–¥–∞–∫—Ç–∏—Ä—É–π `tablet-app/` –±–µ–∑ —è–≤–Ω–æ–π –ø—Ä–æ—Å—å–±—ã
- –ù–µ –º–µ–Ω—è–π shared —Ç–∏–ø—ã –±–µ–∑ –¥–æ–∫—É–º–µ–Ω—Ç–∏—Ä–æ–≤–∞–Ω–∏—è
- –ù–µ –∏—Å–ø–æ–ª—å–∑—É–π `any` –≤ TypeScript
- –ù–µ –ø–∏—à–∏ SQL –Ω–∞–ø—Ä—è–º—É—é ‚Äî –∏—Å–ø–æ–ª—å–∑—É–π ORM (SQLAlchemy)

---

## ‚úÖ –í–°–ï–ì–î–ê –î–ï–õ–ê–ô

- –î–æ–±–∞–≤–ª—è–π type hints –≤ Python
- –ò—Å–ø–æ–ª—å–∑—É–π async/await –¥–ª—è IO –æ–ø–µ—Ä–∞—Ü–∏–π
- –õ–æ–≥–∏—Ä—É–π –≤–∞–∂–Ω—ã–µ —Å–æ–±—ã—Ç–∏—è
- –û–±—Ä–∞–±–∞—Ç—ã–≤–∞–π –æ—à–∏–±–∫–∏ —è–≤–Ω–æ
- –î–æ–∫—É–º–µ–Ω—Ç–∏—Ä—É–π –∏–∑–º–µ–Ω–µ–Ω–∏—è –≤ shared/
- –ü—Ä–µ–¥—É–ø—Ä–µ–∂–¥–∞–π –æ –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ—Å—Ç–∏ —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏–∏ —Å Windsurf
